<% layout("layouts/boilerplate") %>

<div class="container py-5">
  <h2 class="fw-bold text-center mb-4">ğŸ“¦ Your Parcel History</h2>

  <% if (parcels.length === 0) { %>
    <div class="alert alert-info text-center">
      You haven't sent any parcels yet.
    </div>
  <% } else { %>
    <div class="table-responsive">
      <table class="table table-hover align-middle shadow-sm rounded bg-white">
        <thead class="table-light">
          <tr>
            <th>ğŸ“… Date</th>
            <th>ğŸ“ Location</th>
            <th>ğŸ” Locker</th>
            <th>ğŸ‘¤ Receiver</th>
            <th>ğŸ“¦ Type</th>
            <th>ğŸ“ Size</th>
            <th>ğŸ’¸ Cost</th>
            <th>ğŸ“Š Status</th>
          </tr>
        </thead>
        <tbody>
          <% parcels.forEach(parcel => { %>
            <tr>
              <td><%= new Date(parcel.createdAt).toLocaleString() %></td>
              <td><%= parcel.location_id?.name || parcel.location_id?.address || "N/A" %></td>
              <td><%= parcel.lockerId?.lockerBoxId || "N/A" %></td>
              <td><%= parcel.receiverName %> (<%= parcel.receiverPhone %>)</td>
              <td><%= parcel.type %></td>
              <td><%= parcel.size %></td>
              <td>â‚¹<%= parseFloat(parcel.cost).toFixed(2) %></td>
              <td>
                <span class="badge bg-<%= parcel.status === 'delivered' ? 'success' : parcel.status === 'expired' ? 'danger' : 'secondary' %>">
                  <%= parcel.status.charAt(0).toUpperCase() + parcel.status.slice(1) %>
                </span>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  <% } %>
</div>
